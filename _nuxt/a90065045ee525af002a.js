(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{154:function(t,o,i){var e=i(162);"string"==typeof e&&(e=[[t.i,e,""]]),e.locals&&(t.exports=e.locals);(0,i(15).default)("f5749f30",e,!0,{sourceMap:!1})},155:function(t,o,i){var e=i(164);"string"==typeof e&&(e=[[t.i,e,""]]),e.locals&&(t.exports=e.locals);(0,i(15).default)("6e23f0ee",e,!0,{sourceMap:!1})},156:function(t,o,i){var e=i(166);"string"==typeof e&&(e=[[t.i,e,""]]),e.locals&&(t.exports=e.locals);(0,i(15).default)("93f73262",e,!0,{sourceMap:!1})},157:function(t,o,i){var e=i(168);"string"==typeof e&&(e=[[t.i,e,""]]),e.locals&&(t.exports=e.locals);(0,i(15).default)("1ec3ebcb",e,!0,{sourceMap:!1})},160:function(t,o,i){"use strict";var e=i(4),n=i(92)(6),s="findIndex",r=!0;s in[]&&Array(1)[s](function(){r=!1}),e(e.P+e.F*r,"Array",{findIndex:function(t){return n(this,t,arguments.length>1?arguments[1]:void 0)}}),i(44)(s)},161:function(t,o,i){"use strict";var e=i(154);i.n(e).a},162:function(t,o,i){(t.exports=i(14)(!1)).push([t.i,"\n.filter[data-v-e92ee7f0]{padding:72px 16px 16px\n}\n.dtl-filter-body[data-v-e92ee7f0]{padding:0 24px\n}\n.book-list[data-v-e92ee7f0]{padding-bottom:56px\n}\n.create.v-btn.v-btn--icon.theme--light[data-v-e92ee7f0]{margin-top:12px\n}\n.dtl-filter>ul[data-v-e92ee7f0]{box-shadow:none;font-size:14px\n}\n.dtl-filter-header[data-v-e92ee7f0]{background-color:#fafafa;color:#757575\n}\n.v-expansion-panel__body>div[data-v-e92ee7f0]{padding:0\n}\n.v-expansion-panel__body>div>div[data-v-e92ee7f0]{margin-top:0;padding-top:0\n}",""])},163:function(t,o,i){"use strict";var e=i(155);i.n(e).a},164:function(t,o,i){(t.exports=i(14)(!1)).push([t.i,"\n.book-list[data-v-066aab3d]{padding:56px 0\n}",""])},165:function(t,o,i){"use strict";var e=i(156);i.n(e).a},166:function(t,o,i){(t.exports=i(14)(!1)).push([t.i,"\n.book-list[data-v-4e7aa9da]{padding:56px 0\n}\n.theme--light.application .text--primary span[data-v-4e7aa9da]{color:#ff5252!important\n}",""])},167:function(t,o,i){"use strict";var e=i(157);i.n(e).a},168:function(t,o,i){(t.exports=i(14)(!1)).push([t.i,"\n.v-form button[data-v-6ff908b2]{margin-top:24px\n}",""])},174:function(t,o,i){"use strict";i.r(o);i(160),i(90),i(91),i(42),i(43);var e={name:"BookList",props:{bottomNav:String},data:function(){return{search:"",isLending:!1,loadingBookId:null}},computed:{books:function(){var t=this.search,o=this.isLending;return this.$store.state.books.filter(function(i){return(-1!==i.title.indexOf(t)||-1!==i.publisher.indexOf(t)||-1!==i.anthor.indexOf(t))&&(!o||i.isLending)})}},methods:{clickNewBtn:function(){this.$emit("click-new-btn")},clickItem:function(t){this.$emit("click-item",t)},clickBtn:function(t,o){this.$emit("click-btn",t,o)}}},n=(i(161),i(16)),s=Object(n.a)(e,function(){var t=this,o=t.$createElement,i=t._self._c||o;return i("div",{directives:[{name:"show",rawName:"v-show",value:"books"===t.bottomNav,expression:"bottomNav === 'books'"}]},[i("section",{staticClass:"filter"},[i("v-layout",{attrs:{row:"",wrap:""}},[i("v-flex",{attrs:{xs9:"",sm9:""}},[i("v-text-field",{attrs:{label:"書籍名","append-icon":"search",clearable:""},model:{value:t.search,callback:function(o){t.search=o},expression:"search"}})],1),t._v(" "),i("v-flex",{attrs:{xs1:"",sm1:""}},[i("v-spacer")],1),t._v(" "),i("v-flex",{attrs:{xs2:"",sm2:""}},[i("v-btn",{staticClass:"create",attrs:{icon:""},on:{click:t.clickNewBtn}},[i("v-icon",{attrs:{color:"grey darken-1",right:"",large:""}},[t._v("add_box")])],1)],1)],1),t._v(" "),i("v-layout",{staticClass:"dtl-filter",attrs:{row:"",wrap:""}},[i("v-expansion-panel",[i("v-expansion-panel-content",[i("div",{staticClass:"dtl-filter-header",attrs:{slot:"header"},slot:"header"},[t._v("詳細条件")]),t._v(" "),i("div",{staticClass:"dtl-filter-body",attrs:{color:"#fafafa"}},[i("v-checkbox",{attrs:{label:"レンタル中"},model:{value:t.isLending,callback:function(o){t.isLending=o},expression:"isLending"}})],1)])],1)],1)],1),t._v(" "),i("section",{staticClass:"book-list"},[i("v-list",{attrs:{"two-line":""}},[t._l(t.books,function(o,e){return[i("v-list-tile",{key:o.book_id,attrs:{avatar:"",ripple:""},on:{click:function(i){t.clickItem(o.book_id)}}},[i("v-list-tile-content",[i("v-list-tile-title",[t._v(t._s(o.title))]),t._v(" "),i("v-list-tile-sub-title",{staticClass:"text--primary"},[t._v(t._s(o.publisher))]),t._v(" "),i("v-list-tile-sub-title",[t._v(t._s(o.anthor))])],1),t._v(" "),i("v-list-tile-action",[i("v-btn",{directives:[{name:"show",rawName:"v-show",value:!o.isLending,expression:"!item.isLending"}],staticClass:"white--text",attrs:{loading:t.loadingBookId===o.book_id,disabled:t.loadingBookId===o.book_id,color:"#26A69A",ripple:"",fab:""},on:{click:function(i){i.stopPropagation(),t.clickBtn(o.book_id,o.isLending)}}},[i("v-icon",{attrs:{ark:""}},[t._v("redo")])],1),t._v(" "),i("v-btn",{directives:[{name:"show",rawName:"v-show",value:o.isLending&&o.isMine,expression:"item.isLending && item.isMine"}],staticClass:"white--text",attrs:{loading:t.loadingBookId===o.book_id,disabled:t.loadingBookId===o.book_id,color:"#FF8A65",ripple:"",fab:""},on:{click:function(i){i.stopPropagation(),t.clickBtn(o.book_id,o.isLending)}}},[i("v-icon",{attrs:{dark:""}},[t._v("undo")])],1),t._v(" "),i("v-btn",{directives:[{name:"show",rawName:"v-show",value:o.isLending&&!o.isMine,expression:"item.isLending && !item.isMine"}],staticClass:"white--text",attrs:{color:"#90A4AE",ripple:"",fab:""},on:{click:function(t){t.stopPropagation()}}},[i("v-icon",{attrs:{dark:""}},[t._v("not_interested")])],1)],1)],1),t._v(" "),e+1<t.books.length?i("v-divider",{key:"d"+e}):t._e()]})],2)],1)])},[],!1,null,"e92ee7f0",null);s.options.__file="BookList.vue";var r=s.exports,a={name:"MyList",props:{bottomNav:String},data:function(){return{isLending:!1,loadingBookId:null}},computed:{myBooks:function(){return this.$store.state.books.filter(function(t){return t.isMine&&t.isLending})}},methods:{clickItem:function(t){this.$emit("click-item",t)},clickBtn:function(t,o){this.$emit("click-btn",t,o)}}},l=(i(163),Object(n.a)(a,function(){var t=this,o=t.$createElement,i=t._self._c||o;return i("div",{directives:[{name:"show",rawName:"v-show",value:"mylist"===t.bottomNav,expression:"bottomNav === 'mylist'"}]},[i("section",{staticClass:"book-list"},[i("v-list",{attrs:{"two-line":""}},[t._l(t.myBooks,function(o,e){return[i("v-list-tile",{key:o.book_id,attrs:{avatar:"",ripple:""},on:{click:function(i){t.clickItem(o.book_id)}}},[i("v-list-tile-content",[i("v-list-tile-title",[t._v(t._s(o.title))]),t._v(" "),i("v-list-tile-sub-title",{staticClass:"text--primary"},[t._v(t._s(o.publisher))]),t._v(" "),i("v-list-tile-sub-title",[t._v(t._s(o.anthor))])],1),t._v(" "),i("v-list-tile-action",[i("v-btn",{staticClass:"white--text",attrs:{loading:t.loadingBookId===o.book_id,disabled:t.loadingBookId===o.book_id,color:"#FF8A65",ripple:"",fab:""},on:{click:function(i){i.stopPropagation(),t.clickBtn(o.book_id,o.isLending)}}},[i("v-icon",{attrs:{dark:""}},[t._v("undo")])],1)],1)],1),t._v(" "),e+1<t.myBooks.length?i("v-divider",{key:"d"+e}):t._e()]})],2)],1)])},[],!1,null,"066aab3d",null));l.options.__file="MyList.vue";var c=l.exports,d={name:"ExpiredList",props:{bottomNav:String},computed:{expiredBooks:function(){return this.$store.state.books.filter(function(t){return t.isExpired})}}},u=(i(165),Object(n.a)(d,function(){var t=this,o=t.$createElement,i=t._self._c||o;return i("div",{directives:[{name:"show",rawName:"v-show",value:"expired"===t.bottomNav,expression:"bottomNav === 'expired'"}]},[i("section",{staticClass:"book-list"},[i("v-list",{attrs:{"two-line":""}},[t._l(t.expiredBooks,function(o,e){return[i("v-list-tile",{key:o.book_id,attrs:{avatar:""}},[i("v-list-tile-content",[i("v-list-tile-title",[t._v(t._s(o.title))]),t._v(" "),i("v-list-tile-sub-title",{staticClass:"text--primary"},[t._v(t._s(o.publisher))]),t._v(" "),i("v-list-tile-sub-title",{staticClass:"text--primary"},[i("span",[t._v(t._s(o.max_lend_date)+" ")]),t._v(" に\n              "),i("span",[t._v(" "+t._s(o.user_name)+" ")]),t._v(" がレンタル開始\n            ")])],1)],1),t._v(" "),e+1<t.expiredBooks.length?i("v-divider",{key:"d"+e}):t._e()]})],2)],1)])},[],!1,null,"4e7aa9da",null));u.options.__file="ExpiredList.vue";var v={asyncData:function(t){return t.env},data:function(){return{showEditor:!1,editorBook:{valid:!1,bookId:"",title:"",titleRules:[function(t){return!!t||"タイトルを入力してください"},function(t){return t&&t.length<=100||"タイトルは100文字以内で入力してください"}],anthor:"",anthorRules:[function(t){return!!t||"著者を入力してください"},function(t){return t&&t.length<=40||"著者は40文字以内で入力してください"}],publiction:"",publictionRules:[function(t){return!!t||"出版日を入力してください"},function(t){return t&&t.length<=10||"出版日は40文字以内で入力してください"}],publictionMenu:!1,publisher:"",publisherRules:[function(t){return!!t||"出版社を入力してください"},function(t){return t&&t.length<=150||"出版社は150文字以内で入力してください"}],isbn:"",isbnRules:[function(t){return!!t||"ISBNを入力してください"},function(t){return t&&t.toString(10).length<=30||"出版社は30文字以内で入力してください"},function(t){return t&&!!t.toString(10).match(/^[0-9\-]+$/)||"半角数値とハイフンで入力してください"}],showDeleteBtn:!0,headerTitle:"編集"},search:"",isLending:!1,loadingBookId:null,bottomNav:"books",dialog:!1,dialogMsg:""}},mounted:function(){null===this.$store.state.loginInfo?this.$router.push("/"):this.getBooks()},computed:{books:function(){var t=this.search,o=this.isLending;return this.$store.state.books.filter(function(i){return(-1!==i.title.indexOf(t)||-1!==i.publisher.indexOf(t)||-1!==i.anthor.indexOf(t))&&(!o||i.isLending)})},myBooks:function(){return this.$store.state.books.filter(function(t){return t.isMine&&t.isLending})},expiredBooks:function(){return this.$store.state.books.filter(function(t){return t.isExpired})}},methods:{dblclickItem:function(t){var o=this,i=o.books.findIndex(function(o){return o.book_id===t}),e=o.books[i];o.editorBook.bookId=e.book_id,o.editorBook.title=e.title,o.editorBook.anthor=e.anthor,o.editorBook.publiction=e.publiction,o.editorBook.publictionMenu=!1,o.editorBook.publisher=e.publisher,o.editorBook.isbn=e.isbn,o.editorBook.showDeleteBtn=!0,o.editorBook.headerTitle="編集",o.showEditor=!0},clickBtn:function(t,o){var i=this,e=i.books.findIndex(function(o){return o.book_id===t}),n=i.books[e],s=this.$store.state.loginInfo.login_id;i.loadingBookId=t,o?i.returnBook(s,n):i.borrowBook(s,n)},getBooks:function(){var t=this,o=this.$store.state.loginInfo.login_id;this.$store.dispatch("getBooks",{loginId:o,apiBaseUrl:this.API_URL}).catch(function(o){t.$router.push("/")})},borrowBook:function(t,o){var i=this,e=this,n=o.book_id;fetch(this.API_URL+"/api/borrow.php",{method:"POST",body:JSON.stringify({bookId:n,loginId:t})}).then(function(t){if(!t.ok)throw new Error;i.getBooks()}).catch(function(){e.dialog=!0,e.dialogMsg="書籍の貸出に失敗しました"}).finally(function(){e.loadingBookId=null})},returnBook:function(t,o){var i=this,e=this,n=o.max_id;fetch(this.API_URL+"/api/return.php",{method:"POST",body:JSON.stringify({lbId:n,loginId:t})}).then(function(t){if(e.loadingBookId=null,!t.ok)throw new Error;i.getBooks()}).catch(function(){e.dialog=!0,e.dialogMsg="書籍の返却に失敗しました"}).finally(function(){e.loadingBookId=null})},clickSave:function(){var t=this,o=t.editorBook,i=this.$store.state.loginInfo.login_id;fetch(this.API_URL+"/api/edit.php",{method:"POST",body:JSON.stringify({loginId:i,bookId:o.bookId,title:o.title,anthor:o.anthor,publiction:o.publiction,publisher:o.publisher,isbn:o.isbn})}).then(function(o){if(!o.ok)throw new Error;t.getBooks(),t.showEditor=!1}).catch(function(){t.dialog=!0,t.dialogMsg="書籍の編集に失敗しました"}).finally(function(){})},clickDelete:function(){var t=this,o=t.editorBook,i=this.$store.state.loginInfo.login_id;fetch(this.API_URL+"/api/delete.php",{method:"POST",body:JSON.stringify({loginId:i,bookId:o.bookId})}).then(function(o){if(!o.ok)throw new Error;t.getBooks(),t.showEditor=!1}).catch(function(){t.dialog=!0,t.dialogMsg="書籍の削除に失敗しました"}).finally(function(){})},clickNewBtn:function(){this.editorBook.showDeleteBtn=!1,this.editorBook.headerTitle="登録",this.$refs.form.reset(),this.showEditor=!0}},components:{BookList:r,MyList:c,ExpiredList:u.exports}},k=(i(167),Object(n.a)(v,function(){var t=this,o=t.$createElement,i=t._self._c||o;return i("div",[i("book-list",{attrs:{bottomNav:t.bottomNav},on:{"click-new-btn":t.clickNewBtn,"click-item":t.dblclickItem,"click-btn":t.clickBtn}}),t._v(" "),i("my-list",{attrs:{bottomNav:t.bottomNav},on:{"click-item":t.dblclickItem,"click-btn":t.clickBtn}}),t._v(" "),i("expired-list",{attrs:{bottomNav:t.bottomNav}}),t._v(" "),i("v-bottom-nav",{attrs:{active:t.bottomNav,value:!0,fixed:"",color:"white"},on:{"update:active":function(o){t.bottomNav=o}}},[i("v-btn",{attrs:{color:"teal",flat:"",value:"books"}},[i("span",[t._v("書籍一覧")]),t._v(" "),i("v-icon",[t._v("library_books")])],1),t._v(" "),i("v-btn",{attrs:{color:"teal",flat:"",value:"mylist"}},[i("span",[t._v("マイリスト")]),t._v(" "),i("v-icon",[t._v("list")])],1),t._v(" "),i("v-btn",{attrs:{color:"teal",flat:"",value:"expired"}},[i("span",[t._v("期限切れ")]),t._v(" "),i("v-icon",[t._v("access_alarm")])],1)],1),t._v(" "),i("v-dialog",{attrs:{"max-width":"290"},model:{value:t.dialog,callback:function(o){t.dialog=o},expression:"dialog"}},[i("v-card",[i("v-card-title",{staticClass:"headline"},[t._v("エラー")]),t._v(" "),i("v-card-text",[t._v("\n        "+t._s(t.dialogMsg)+"\n      ")])],1)],1),t._v(" "),i("v-dialog",{attrs:{fullscreen:"","hide-overlay":"",transition:"dialog-bottom-transition",scrollable:""},model:{value:t.showEditor,callback:function(o){t.showEditor=o},expression:"showEditor"}},[i("v-card",{attrs:{tile:""}},[i("v-toolbar",{attrs:{card:"",dark:"",color:"grey darken-1"}},[i("v-toolbar-title",[t._v("書籍の"+t._s(t.editorBook.headerTitle))]),t._v(" "),i("v-spacer"),t._v(" "),i("v-btn",{attrs:{icon:"",dark:""},nativeOn:{click:function(o){t.showEditor=!1}}},[i("v-icon",[t._v("close")])],1)],1),t._v(" "),i("v-card-text",[i("v-form",{ref:"form",attrs:{"lazy-validation":""},model:{value:t.editorBook.valid,callback:function(o){t.$set(t.editorBook,"valid",o)},expression:"editorBook.valid"}},[i("v-text-field",{attrs:{rules:t.editorBook.titleRules,counter:100,label:"タイトル","prepend-icon":"book",required:""},model:{value:t.editorBook.title,callback:function(o){t.$set(t.editorBook,"title",o)},expression:"editorBook.title"}}),t._v(" "),i("v-text-field",{attrs:{rules:t.editorBook.anthorRules,counter:40,label:"著者","prepend-icon":"create",required:""},model:{value:t.editorBook.anthor,callback:function(o){t.$set(t.editorBook,"anthor",o)},expression:"editorBook.anthor"}}),t._v(" "),i("v-menu",{ref:"publictionMenu",attrs:{"close-on-content-click":!1,"nudge-right":40,"return-value":t.editorBook.publiction,lazy:"",transition:"scale-transition","offset-y":"","full-width":"","min-width":"290px"},on:{"update:returnValue":function(o){t.$set(t.editorBook,"publiction",o)}},model:{value:t.editorBook.publictionMenu,callback:function(o){t.$set(t.editorBook,"publictionMenu",o)},expression:"editorBook.publictionMenu"}},[i("v-text-field",{attrs:{slot:"activator",label:"出版日","prepend-icon":"history",readonly:""},slot:"activator",model:{value:t.editorBook.publiction,callback:function(o){t.$set(t.editorBook,"publiction",o)},expression:"editorBook.publiction"}}),t._v(" "),i("v-date-picker",{on:{input:function(o){t.$refs.publictionMenu.save(t.editorBook.publiction)}},model:{value:t.editorBook.publiction,callback:function(o){t.$set(t.editorBook,"publiction",o)},expression:"editorBook.publiction"}})],1),t._v(" "),i("v-text-field",{attrs:{rules:t.editorBook.publisherRules,counter:150,label:"出版社","prepend-icon":"domain",required:""},model:{value:t.editorBook.publisher,callback:function(o){t.$set(t.editorBook,"publisher",o)},expression:"editorBook.publisher"}}),t._v(" "),i("v-text-field",{attrs:{rules:t.editorBook.isbnRules,counter:30,label:"ISBN","prepend-icon":"exposure_zero",required:""},model:{value:t.editorBook.isbn,callback:function(o){t.$set(t.editorBook,"isbn",o)},expression:"editorBook.isbn"}}),t._v(" "),i("v-btn",{attrs:{block:"",color:"#26A69A",dark:t.editorBook.valid,disabled:!t.editorBook.valid},on:{click:t.clickSave}},[t._v("\n            保存\n            "),i("v-icon",{attrs:{right:"",dark:""}},[t._v("save")])],1),t._v(" "),i("v-btn",{directives:[{name:"show",rawName:"v-show",value:t.editorBook.showDeleteBtn,expression:"editorBook.showDeleteBtn"}],attrs:{block:"",color:"#FF8A65",dark:""},on:{click:t.clickDelete}},[t._v("\n            削除\n            "),i("v-icon",{attrs:{right:"",dark:""}},[t._v("delete")])],1)],1)],1),t._v(" "),i("div",{staticStyle:{flex:"1 1 auto"}})],1)],1)],1)},[],!1,null,"6ff908b2",null));k.options.__file="index.vue";o.default=k.exports}}]);